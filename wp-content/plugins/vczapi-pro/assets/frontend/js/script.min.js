"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(l){var n={init:function(){this._cacheDOM(),this._evntListeners()},_cacheDOM:function(){this.$allOccurrences=l(".zvc-all-occurrences"),0<this.$allOccurrences.length&&(this.$allOccurrencesToggler=this.$allOccurrences.find(".zvc-all-occurrences__toggle-button"),this.$allOccurrencesList=this.$allOccurrences.find(".zvc-all-occurrences__list"))},_evntListeners:function(){0<this.$allOccurrences.length&&this.$allOccurrencesToggler.on("click",this.toggleAllOccurrences.bind(this)),0<l(".vczapi-pro-datatable-render").length&&l(".vczapi-pro-datatable-render").dataTable({order:[1,"asc"],responsive:!0,language:vczapi_dt_i18n})},toggleAllOccurrences:function(e){e.preventDefault(),this.$allOccurrencesList.toggle()},_isValidEmailAddress:function(e){return new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i).test(e)}},e={init:function(){this._cacheDOM(),this._evntListeners()},_cacheDOM:function(){},_evntListeners:function(){l(document).on("submit","#vczapi-pro-registration-form",this.registerUser.bind(this))},registerUser:function(e){e.preventDefault();var t=l(e.currentTarget).serializeArray(),i=l(".vczapi-pro-registration-notice");if(this._validateFormData(e,t)){t.push({name:"action",value:"register_user"}),i.html("<p>Loading. Please wait..</p>").show();var r=l(".vczapi-pro-registration-form");l.post(vczapi_pro.ajaxurl,t).done(function(e){if(!1===e.success&&(i.html('<p class="vczapi-pro-registration-data-result-failed">'+e.data+"</p>").show(),l("html, body").animate({scrollTop:l(".vczapi-pro-registration-data-result-failed").offset().top-100},500)),!0===e.success){l(r).html('<p class="vczapi-pro-registration-data-result">'+e.data+"</p>").show();var t=new Event("vczapi_pro_user_registered");document.querySelector("html").dispatchEvent(t),i.html("").hide()}})}},_validateFormData:function(e){var t=!0,i=l(e.currentTarget).find("#first_name");""===i.val()?l(i).next(".error").length||(l(i).css("border-color","red").after('<p class="error">'+vczapi_pro.first_name_required+"</p>"),t=!1):l(i).css("border-color","#ddd").next(".error").remove();var r=l(e.currentTarget).find("#last_name");""===r.val()?(l(r).next(".error").length||l(r).css("border-color","red").after('<p class="error">'+vczapi_pro.last_name_required+"</p>"),t=!1):l(r).css("border-color","#ddd").next(".error").remove();var a=l(e.currentTarget).find("#email_address");return""!==a.val()&&n._isValidEmailAddress(a.val())?l(a).css("border-color","#ddd").next(".error").remove():(l(a).next(".error").length||l(a).css("border-color","red").after('<p class="error">'+vczapi_pro.email_required+"</p>"),t=!1),t}},t={init:function(){this._cacheDOM(),this._loadDependencies()},_cacheDOM:function(){this.select2=l(".vczapi-pro-form-control-select2"),this.createMeetingForm=l("#vczapi-pro-frontend-meeting-create-form"),this.startTimePicker=l("#vczapi-pro-meeting-start-time"),this.notificationHolder=l(".vczapi-api-meeting-create-notifications"),this.authrMeetingListTbl=l("#vczapi-pro-frontend-author-meeting-list-table"),this.selectAllMeetings=l(".vczapi-pro-frontend-author-meeting-select-all"),this.selectCertainMeetings=l(".vczapi-pro-frontend-author-meetings")},_loadDependencies:function(){if(0<this.select2.length&&this.select2.select2(),0<this.startTimePicker.length){var e=new Date,t=e.getMonth()+1,i=e.getDate(),r=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),a=e.getFullYear()+"-"+(t<10?"0":"")+t+"-"+(i<10?"0":"")+i+" "+r,n=this.startTimePicker.data("existingdate");n&&(a=n),this.startTimePicker.datetimepicker({value:a,step:30,minDate:0,format:"Y-m-d H:i",mask:!0})}if(0<l(this.authrMeetingListTbl).length){var o=!1;o="undefined"!=typeof vczapi_view&&vczapi_view.list_registrants?{ajaxurl:vczapi_pro.ajaxurl+"?action=get_author_meeting_list&list=registrants&pg="+vczapi_pro.current_page,columns:[{data:"title"},{data:"start_date"},{data:"meeting_id"},{data:"type"},{data:"view_registrants"}],colmDefs:!1,order:[1,"desc"]}:{ajaxurl:vczapi_pro.ajaxurl+"?action=get_author_meeting_list&pg="+vczapi_pro.current_page,columns:[{data:"sort"},{data:"title"},{data:"start_date"},{data:"meeting_id"},{data:"type"},{data:"start_link"}],colmDefs:[{render:function(e,t,i){return e+'<div class="vczapi-pro-frontend-mtg-actions"><a href="'+i.edit_link+'" class="vczapi-pro-frontend-mtg-actions-edit">Edit</a> | <a href="'+i.permalink+'" class="vczapi-pro-frontend-mtg-actions-view">View</a></div>'},targets:1},{render:function(e,t,i){return'<input type="checkbox" name="meeting-select[]" value="'+i.post_id+'" class="vczapi-pro-frontend-author-meetings vczapi-pro-frontend-author-meeting-'+i.post_id+'">'},targets:0,orderable:!1}],order:[2,"desc"]},l(this.authrMeetingListTbl).dataTable({ajax:{url:o.ajaxurl},columns:o.columns,order:[o.order],columnDefs:o.colmDefs,responsive:!0,language:vczapi_dt_i18n})}this.createMeetingForm.on("submit",this.createMeeting.bind(this)),l(".vczapi-pro-meeting-password").on("keypress",this.meetingPassword.bind(this)),this.selectAllMeetings.on("click",this.selectBulkMtgs.bind(this)),l(document).on("click",this.selectCertainMeetings,this.selectAMeetingForAction.bind(this)),l(document).on("click",".vczapi-pro-view-registrants",this.viewRegistrantsCallback.bind(this)),l(document).on("click",".vczapi-modal-close",this.closeRegistrantsPopup.bind(this))},dataValidation:function(e){var t=this.notificationHolder,r=!0;return l(e.currentTarget).find("input, select").each(function(e,t){if(!0===l(t).data("required")){var i=l(t).attr("name");null===t.value||""===t.value?(l(".vczapi-pro-"+i+"-validate-error").length||l(t).parent().addClass("vczapi-pro-field-validate-error"),r=!1):(l(t).parent().removeClass("vczapi-pro-field-validate-error"),l(".vczapi-pro-"+i+"-validate-error").remove())}}),r?t.html(""):(t.html('<p class="vczapi-api-meeting-create-notifications-error">Required fields are missing !</p>'),l("html, body").animate({scrollTop:l(".vczapi-api-meeting-create-notifications-error").offset().top-80},500)),r},viewRegistrantsCallback:function(e){e.preventDefault();var t={post_id:l(e.currentTarget).data("post"),action:"get_meeting_registrants"};l(".vczapi-modal").html('<p class="vczapi-modal-loader">'+vczapi_view.loading+"</p>").show(),l.get(vczapi_pro.ajaxurl,t).done(function(e){l(".vczapi-modal").html(e.data).show()})},closeRegistrantsPopup:function(e){e.preventDefault(),l(".vczapi-modal-content").remove(),l(".vczapi-modal").hide()},createMeeting:function(e){e.preventDefault();var t=this.notificationHolder;if(this.dataValidation(e)){var i=l(e.currentTarget).serialize()+"&action=create_meeting_frontend",r=l(e.currentTarget).find('input[name="redirect_to"]').val();l(".vczapi-pro-form-fields").remove(),t.html('<p class="vczapi-api-meeting-create-notifications-success">Submitting Form.. Please wait..</p>'),l.post(vczapi_pro.ajaxurl,i).done(function(e){console.log(e),!0===e.success?(t.html('<p class="vczapi-api-meeting-create-notifications-success">'+e.data+"</p>"),window.location.href=r):(t.html('<p class="vczapi-api-meeting-create-notifications-error">'+e.data+"</p>"),location.reload())})}},meetingPassword:function(e){if(!/([a-zA-Z0-9])+/.test(String.fromCharCode(e.which)))return!1;var t=l(this).val(),i=l(this).data("maxlength");0<i&&l(this).val(t.substr(0,i))},selectBulkMtgs:function(e){l(e.currentTarget).is(":checked")?(l(".vczapi-pro-frontend-author-meetings").prop("checked",!0),0===l(".vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete").length&&l("#vczapi-pro-frontend-author-meeting-list-table_filter").append("<div id='vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete' class='vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete'><a href='javascript:void(0);'>Move to Trash</a></div>")):(l(".vczapi-pro-frontend-author-meetings").prop("checked",!1),l("#vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete").remove())},selectAMeetingForAction:function(){var i=!0;l(".vczapi-pro-frontend-author-meetings").each(function(e,t){if(l(t).is(":checked"))return i=!1}),i?l("#vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete").remove():0===l(".vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete").length&&l("#vczapi-pro-frontend-author-meeting-list-table_filter").append("<div id='vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete' class='vczapi-pro-frontend-author-meeting-list-table_filter-bulk_delete'><a href='javascript:void(0);'>Move to Trash</a></div>")}},i={init:function(){this.cacheDOM(),0<this.$calendarEl.length&&this.renderCalendar()},cacheDOM:function(){this.meetings=[],this.$calendarEl=l(".vczapi-pro-calendar"),window.tippyInstances=[]},renderCalendar:function(){var n=document.documentElement.lang;this.$calendarEl.each(function(e,c){var t=l(this),i=t.data("calendar_default_view"),r=Intl.DateTimeFormat().resolvedOptions().timeZone,a={initialView:i,initialDate:new Date,locale:n,events:{url:vczapi_pro.ajaxurl+"?action=vczapi_get_calendar_meetings",extraParams:{author:t.data("author"),show:t.data("show"),timezone:r}},loading:function(e){var t=l(this.el);e?t.parent(".vczapi-pro-calendar-container").find(".vczapi-pre-loader").show():t.parent(".vczapi-pro-calendar-container").find(".vczapi-pre-loader").hide()},eventClick:function(e){if(e.jsEvent.preventDefault(),c.dataset.hasOwnProperty("show_popup")&&"yes"===c.dataset.show_popup){tippyInstances.forEach(function(e){e.destroy()}),tippyInstances.length=0;var t=l(this.el).parent().find(".vczapi-calendar-tpl")[0].innerHTML,i=e.event,r=i.extendedProps,a={title:i.title};for(var n in r)r.hasOwnProperty(n)&&(a[n]=r[n]);var o=function(e,i){if(e="function"==typeof e?e():e,-1===["string","number"].indexOf(_typeof(e)))throw"PlaceholdersJS: please provide a valid template";return i?e=e.replace(/\{\{([^}]+)\}\}/g,function(e){e=e.slice(2,-2);var t=function(e,t,i){t=function(e){if("string"!=typeof e)return e;var t=[];return e.split(".").forEach(function(e){e.split(/\[([^}]+)\]/g).forEach(function(e){0<e.length&&t.push(e)})}),t}(t);for(var r=e,a=0;a<t.length;a++){if(!r[t[a]])return i;r=r[t[a]]}return r}(i,e);return t||""}):"template"}(t,a),s=tippy(e.el,{content:'<div class="vczapi-calendar-tooltip">'+o+"</div>",interactive:!0,allowHTML:!0,theme:"light",trigger:"click",zIndex:99999,showOnCreate:!0,popperOptions:{strategy:"fixed",container:"body",arrow:!1}});window.tippyInstances=tippyInstances.concat(s)}else c.dataset.hasOwnProperty("show_popup")&&"no"===c.dataset.show_popup&&(window.location=e.event.url)},views:{dayGridMonth:{dayMaxEventRows:3,eventTimeFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"short"}}}};"yes"===t.data("show_calendar_views")&&(a.headerToolbar={left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"}),new FullCalendar.Calendar(t[0],a).render()})}};l(function(){n.init(),e.init(),t.init(),i.init()})}(jQuery);